{"code":"!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=0)}([function(t,e,i){\"use strict\";i.r(e);class s{constructor(t,e,i,s){this.sprite=t.physics.add.sprite(e.x,e.y,\"pacman\").setScale(.9).setOrigin(.5),this.spawnPoint=e,this.anim=i,this.dieCallback=s,this.speed=95,this.moveTo=new Phaser.Geom.Point,this.sprite.angle=180,this.safetile=[-1,18],this.directions=[],this.opposites=[null,null,null,null,null,Phaser.DOWN,Phaser.UP,Phaser.RIGHT,Phaser.LEFT],this.turning=Phaser.NONE,this.current=Phaser.NONE,this.turningPoint=new Phaser.Geom.Point,this.threshold=5,this.life=3,this.score=0,this.active=!0,this.sprite.anims.play(this.anim.Stay,!0);let r=this;this.sprite.on(\"animationcomplete\",function(t,e){r.animComplete(t,e)},t),this.playing=!1}die(){this.active=!1,this.playing=!1,this.life--,this.moveTo=new Phaser.Geom.Point,this.sprite.anims.play(this.anim.Die,!0)}animComplete(t,e){t.key==this.anim.Die&&this.dieCallback()}respawn(){this.active=!0,this.playing=!1,this.sprite.setPosition(this.spawnPoint.x,this.spawnPoint.y),this.moveTo=new Phaser.Geom.Point,this.sprite.anims.play(this.anim.Stay,!0),this.sprite.angle=180,this.turning=Phaser.NONE,this.current=Phaser.NONE}moveLeft(){this.moveTo.x=-1,this.moveTo.y=0,this.sprite.anims.play(this.anim.Eat,!0),this.sprite.angle=180}moveRight(){this.moveTo.x=1,this.moveTo.y=0,this.sprite.anims.play(this.anim.Eat,!0),this.sprite.angle=0}moveUp(){this.moveTo.x=0,this.moveTo.y=-1,this.sprite.anims.play(this.anim.Eat,!0),this.sprite.angle=270}moveDown(){this.moveTo.x=0,this.moveTo.y=1,this.sprite.anims.play(this.anim.Eat,!0),this.sprite.angle=90}update(){this.sprite.setVelocity(this.moveTo.x*this.speed,this.moveTo.y*this.speed),this.turn(),this.directions[this.current]&&!this.isSafe(this.directions[this.current].index)&&this.sprite.anims.play(\"faceRight\",!0)}setDirections(t){this.directions=t}setTurningPoint(t){this.turningPoint=t}setTurn(t){if(!this.active||!this.directions[t]||this.turning===t||this.current===t||!this.isSafe(this.directions[t].index))return!1;this.opposites[t]&&this.opposites[t]===this.current?(this.move(t),this.turning=Phaser.NONE,this.turningPoint=new Phaser.Geom.Point):this.turning=t}turn(){return this.turning!==Phaser.NONE&&(!(!Phaser.Math.Within(this.sprite.x,this.turningPoint.x,this.threshold)||!Phaser.Math.Within(this.sprite.y,this.turningPoint.y,this.threshold))&&(this.sprite.setPosition(this.turningPoint.x,this.turningPoint.y),this.move(this.turning),this.turning=Phaser.NONE,this.turningPoint=new Phaser.Geom.Point,!0))}move(t){switch(this.playing=!0,this.current=t,t){case Phaser.LEFT:this.moveLeft();break;case Phaser.RIGHT:this.moveRight();break;case Phaser.UP:this.moveUp();break;case Phaser.DOWN:this.moveDown()}}isSafe(t){for(let e of this.safetile)if(e===t)return!0;return!1}drawDebug(t){let e=65280;for(var i=0;i<9;i++)null!==this.directions[i]&&void 0!==this.directions[i]&&(e=-1!==this.directions[i].index?16711680:65280,t.lineStyle(4,e,1),t.strokeRect(this.directions[i].pixelX,this.directions[i].pixelY,32,32));e=65280,t.lineStyle(4,e,1),t.strokeRect(this.turningPoint.x,this.turningPoint.y,1,1)}}class r{constructor(t,e,i){this.sprite=t.physics.add.sprite(e.x,e.y,\"ghost\").setScale(.85).setOrigin(.5),this.spawnPoint=e,this.anim=i,this.speed=100,this.moveTo=new Phaser.Geom.Point,this.safetile=[-1,19],this.directions=[],this.opposites=[null,null,null,null,null,Phaser.DOWN,Phaser.UP,Phaser.RIGHT,Phaser.LEFT],this.turning=Phaser.NONE,this.current=Phaser.NONE,this.turningPoint=new Phaser.Geom.Point,this.threshold=5,this.rnd=new Phaser.Math.RandomDataGenerator,this.sprite.anims.play(i.Move,!0),this.turnCount=0,this.turnAtTime=[4,8,16,32,64],this.turnAt=this.rnd.pick(this.turnAtTime)}freeze(){this.moveTo=new Phaser.Geom.Point,this.current=Phaser.NONE}move(){this.move(this.rnd.pick([Phaser.UP,Phaser.DOWN]))}respawn(){this.sprite.setPosition(this.spawnPoint.x,this.spawnPoint.y),this.move(this.rnd.pick([Phaser.UP,Phaser.DOWN])),this.sprite.flipX=!1}moveLeft(){this.moveTo.x=-1,this.moveTo.y=0,this.sprite.flipX=!0,this.sprite.angle=0}moveRight(){this.moveTo.x=1,this.moveTo.y=0,this.sprite.flipX=!1,this.sprite.angle=0}moveUp(){this.moveTo.x=0,this.moveTo.y=-1,this.sprite.angle=0}moveDown(){this.moveTo.x=0,this.moveTo.y=1,this.sprite.angle=0}update(){this.sprite.setVelocity(this.moveTo.x*this.speed,this.moveTo.y*this.speed),this.turn(),this.directions[this.current]&&!this.isSafe(this.directions[this.current].index)&&(this.sprite.anims.play(\"faceRight\",!0),this.takeRandomTurn())}setDirections(t){this.directions=t}setTurningPoint(t){this.turningPoint=t}setTurn(t){if(!this.directions[t]||this.turning===t||this.current===t||!this.isSafe(this.directions[t].index))return!1;this.opposites[t]&&this.opposites[t]===this.current?(this.move(t),this.turning=Phaser.NONE,this.turningPoint=new Phaser.Geom.Point):this.turning=t}takeRandomTurn(){let t=[];for(let e=0;e<this.directions.length;e++){let i=this.directions[e];i&&this.isSafe(i.index)&&t.push(e)}if(t.length>=2){let e=t.indexOf(this.opposites[this.current]);e>-1&&t.splice(e,1)}let e=this.rnd.pick(t);this.setTurn(e),this.turnCount=0,this.turnAt=this.rnd.pick(this.turnAtTime)}turn(){return this.turnCount===this.turnAt&&this.takeRandomTurn(),this.turnCount++,this.turning!==Phaser.NONE&&(!(!Phaser.Math.Within(this.sprite.x,this.turningPoint.x,this.threshold)||!Phaser.Math.Within(this.sprite.y,this.turningPoint.y,this.threshold))&&(this.sprite.setPosition(this.turningPoint.x,this.turningPoint.y),this.move(this.turning),this.turning=Phaser.NONE,this.turningPoint=new Phaser.Geom.Point,!0))}move(t){switch(this.current=t,t){case Phaser.LEFT:this.moveLeft();break;case Phaser.RIGHT:this.moveRight();break;case Phaser.UP:this.moveUp();break;case Phaser.DOWN:this.moveDown()}}isSafe(t){for(let e of this.safetile)if(e===t)return!0;return!1}drawDebug(t){let e=65280;for(var i=0;i<9;i++)null!==this.directions[i]&&void 0!==this.directions[i]&&(e=this.isSafe(this.directions[i].index)?65280:16711680,t.lineStyle(4,e,1),t.strokeRect(this.directions[i].pixelX,this.directions[i].pixelY,32,32));e=65280,t.lineStyle(4,e,1),t.strokeRect(this.turningPoint.x,this.turningPoint.y,1,1)}}let n,h,a,o,l,p,u,m,c=896,d=32,f=parseInt(d/2),P={type:Phaser.AUTO,width:c,height:640,parent:\"game-container\",physics:{default:\"arcade\",arcade:{debug:!1,gravity:{x:0,y:0}}},scene:{preload:function(){this.load.spritesheet(w,N,{frameWidth:d,frameHeight:d}),this.load.tilemapTiledJSON(\"map\",b),this.load.image(x,O),this.load.image(\"pill\",\"images/pac man pill/spr_pill_0.png\"),this.load.image(\"lifecounter\",\"images/pac man life counter/spr_lifecounter_0.png\")},create:function(){this.anims.create({key:k.Player.Eat,frames:this.anims.generateFrameNumbers(w,{start:9,end:13}),frameRate:10,repeat:-1}),this.anims.create({key:k.Player.Stay,frames:[{key:w,frame:9}],frameRate:20}),this.anims.create({key:k.Player.Die,frames:this.anims.generateFrameNumbers(w,{start:6,end:8}),frameRate:1}),this.anims.create({key:k.Ghost.Blue.Move,frames:this.anims.generateFrameNumbers(w,{start:0,end:1}),frameRate:10,repeat:-1}),this.anims.create({key:k.Ghost.Orange.Move,frames:this.anims.generateFrameNumbers(w,{start:4,end:5}),frameRate:10,repeat:-1}),this.anims.create({key:k.Ghost.White.Move,frames:this.anims.generateFrameNumbers(w,{start:4,end:5}),frameRate:10,repeat:-1}),this.anims.create({key:k.Ghost.Pink.Move,frames:this.anims.generateFrameNumbers(w,{start:14,end:15}),frameRate:10,repeat:-1}),this.anims.create({key:k.Ghost.Red.Move,frames:this.anims.generateFrameNumbers(w,{start:16,end:17}),frameRate:10,repeat:-1});const t=(o=this.make.tilemap({key:\"map\",tileWidth:d,tileHeight:d})).addTilesetImage(x);(l=o.createStaticLayer(\"Layer 1\",t,0,0)).setCollisionByProperty({collides:!0}),(p=o.createStaticLayer(\"Layer 2\",t,0,0)).setCollisionByProperty({collides:!0});let e=o.findObject(\"Objects\",t=>\"player1 spawn point\"===t.name),i=new Phaser.Geom.Point(e.x+f,e.y-f);h=new s(this,i,k.Player,function(){h.life<=0?function(){R(),h.life=3,h.score=0;for(let t=0;t<h.life;t++){let e=T[t];e&&(e.alpha=1)}}():G()});let c=this;a=this.physics.add.group(),o.filterObjects(\"Objects\",function(t,e,i){if(\"Pill\"==t.name){let e=c.physics.add.sprite(t.x+f,t.y-f,\"pill\");a.add(e),y++}});let P=this.physics.add.group(),N=0,O=[k.Ghost.Blue,k.Ghost.Red,k.Ghost.Orange,k.Ghost.Pink];o.filterObjects(\"Objects\",function(t,e,i){if(\"Ghost\"==t.name){let e=new Phaser.Geom.Point(t.x+f,t.y-f),i=new r(c,e,O[N]);g.push(i),P.add(i.sprite),N++}}),this.physics.add.collider(h.sprite,l),this.physics.add.collider(h.sprite,p),this.physics.add.collider(P,l),this.physics.add.overlap(h.sprite,a,function(t,e){e.disableBody(!0,!0),v++,h.score+=10,y==v&&R()},null,this),this.physics.add.overlap(h.sprite,P,function(t,e){if(h.active){h.die();for(let t of g)t.freeze()}},null,this),n=this.input.keyboard.createCursorKeys(),u=this.add.graphics(),m=this.add.text(25,595,\"Score: \"+h.score).setFontFamily(\"Arial\").setFontSize(18).setColor(\"#ffffff\"),this.add.text(630,595,\"Lives:\").setFontFamily(\"Arial\").setFontSize(18).setColor(\"#ffffff\");for(let t=0;t<h.life;t++)T.push(this.add.image(700+25*t,605,\"lifecounter\"))},update:function(){if(h.setDirections(S(o,l,h.sprite)),!h.playing)for(let t of g)t.freeze();for(let t of g)t.setDirections(S(o,l,t.sprite));h.setTurningPoint(D(o,h.sprite));for(let t of g)t.setTurningPoint(D(o,t.sprite));n.left.isDown?h.setTurn(Phaser.LEFT):n.right.isDown?h.setTurn(Phaser.RIGHT):n.up.isDown?h.setTurn(Phaser.UP):n.down.isDown?h.setTurn(Phaser.DOWN):h.setTurn(Phaser.NONE);h.update();for(let t of g)t.update();m.setText(\"Score: \"+h.score);for(let t=h.life;t<3;t++){let e=T[t];e&&(e.alpha=0)}h.active&&(h.sprite.x<0-f?h.sprite.setPosition(c+f,h.sprite.y):h.sprite.x>c+f&&h.sprite.setPosition(0-f,h.sprite.y))}}},g=(new Phaser.Game(P),[]),y=0,v=0,T=[],x=\"tiles\",w=\"pacman-spritesheet\",N=\"images/pacmansprites.png\",O=\"images/map/tiles-32px.png\",b=\"images/map/tilemap.json\",k={Player:{Eat:\"player-eat\",Stay:\"player-stay\",Die:\"player-die\"},Ghost:{Blue:{Move:\"ghost-blue-move\"},Orange:{Move:\"ghost-orange-move\"},White:{Move:\"ghost-white-move\"},Pink:{Move:\"ghost-pink-move\"},Red:{Move:\"ghost-red-move\"}}};function G(){h.respawn();for(let t of g)t.respawn()}function R(){G();for(let t of a.getChildren())t.enableBody(!1,t.x,t.y,!0,!0);v=0}function S(t,e,i){let s=[],r=Phaser.Math.FloorTo(i.x),n=Phaser.Math.FloorTo(i.y),h=t.getTileAtWorldXY(r,n,!0);if(h){var a=h.x,o=h.y;s[Phaser.LEFT]=t.getTileAt(a-1,o,!0,e),s[Phaser.RIGHT]=t.getTileAt(a+1,o,!0,e),s[Phaser.UP]=t.getTileAt(a,o-1,!0,e),s[Phaser.DOWN]=t.getTileAt(a,o+1,!0,e)}return s}function D(t,e){let i=new Phaser.Geom.Point,s=Phaser.Math.FloorTo(e.x),r=Phaser.Math.FloorTo(e.y),n=t.getTileAtWorldXY(s,r,!0);return n&&(i.x=n.pixelX+f,i.y=n.pixelY+f),i}}]);","extractedComments":[]}